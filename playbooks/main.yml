---
- hosts: all
  tasks:
    - shell: echo "STARTING" > /tmp/portaltest
    
# Basic, common settings
- hosts: all
#  tasks:
#    - shell: echo "Last provisioning began $(date)" > {{ provision__base_dir }}/provisioning.txt
#    - git:  
#        repo={{ edx__repo }}
#        version={{ edx__version }}
#        dest={{ edx__provision_dir }}
#    
#    - apt:
#        name={{ item }}
#        state=installed
#      with_items: edx__prereq_packages
    
  roles:
    - portal_edx
    - vidtest
      
  # TODO: This should go elsewhere...
  handlers:
    - name: reload nginx
      service: name=nginx state=reloaded

# Hand off to profiles mapped to groups returned by scripts/inventory.py
#- include: profiles.yml

# Timestamp
- hosts: all
  tasks:
    - shell: echo "Last provisioning completed $(date)" >> {{ provision__base_dir }}/provisioning.txt
